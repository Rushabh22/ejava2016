<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
         <title>Notice Board</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">		

        <script src="bower_components/jquery/dist/jquery.js"></script>       
        <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css"/>
        <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    </head>
    <body>
        <textarea id="notes" cols="50" rows="10" disabled></textarea>

        <br>
        <input type="text" id="message" size="30">
        <button type="button" id="sendBtn" >Send</button> <!--Test -->
        <select id="category">
            <option value="Social">Social</option>
            <option value="For Sale">For Sale</option>
            <option value="Jobs">Jobs</option>
            <option value="Tuition">Tuition</option>
        </select>
        <input type="button" onclick="connectWebSocket()" value="Connect">
        <script>
            function connectWebSocket () {
                var category = $("#category").val();              
                var url = "ws://localhost:8080/ejava_wk4_websocket/chat/"+category;
                var socket = new WebSocket(url);
                socket.onopen = function () {
                    $("#notes").val("Connected\n");
                    $("#category").prop("disabled", true);
                }
                socket.onmessage = function (evt) {                   
                    var data = JSON.parse(evt.data);
                    $("#notes").val("Title:  " + data.title + "\n" 
                            + "Time :  " + data.time + "\n" 
                            + "Who : " + data.who  + "\n" 
                            + "Category :  " + data.category + "\n" 
                            + "Content :  " + data.content + "\n" + "\n" 
                            + $("#notes").val());
                }
                $("#sendBtn").on("click", function () {                  
                    socket.send($("#message").val())
                    $("#message").val("")                  
                })                
            }            
        </script>
    </body>
</html>
